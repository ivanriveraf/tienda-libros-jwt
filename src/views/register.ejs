<%- include('layout', { body: `
  <div class="row justify-content-center">
    <div class="col-md-4">
      <h2 class="mb-3 text-success text-center">Registro</h2>
      <form id="formRegistro">
        <div class="mb-3">
          <label class="form-label">Usuario</label>
          <input type="text" name="username" class="form-control" required />
        </div>
        <div class="mb-3">
          <label class="form-label">Contraseña</label>
          <input type="password" name="password" class="form-control" required />
        </div>
        <button class="btn btn-success w-100">Crear cuenta</button>
      </form>
      <div id="regMsg" class="mt-2"></div>
    </div>
  </div>

  <script>
    const formRegistro = document.getElementById('formRegistro');
    formRegistro.addEventListener('submit', async (e) => {
      e.preventDefault();
      const data = Object.fromEntries(new FormData(formRegistro));
      const res = await fetch('/api/auth/registro', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data),
      });
      const json = await res.json();
      const msg = document.getElementById('regMsg');

      if (json.usuario) {
        msg.innerHTML =
          '<div class="alert alert-success">Usuario registrado, ahora puedes iniciar sesión.</div>';
      } else {
        msg.innerHTML =
          '<div class="alert alert-danger">' + (json.msg || 'Error') + '</div>';
      }
    });
  </script>
` }) %>
